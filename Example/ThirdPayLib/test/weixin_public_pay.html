<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<script type="text/javascript" src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js "></script>
<script type="text/javascript">
var	json = "{\"appId\":\"wx19783cdd5801fa65\",\"nonceStr\":\"201611101700472036091847\",\"signType\":\"MD5\",\"timeStamp\":\"1478768447\",\"package\":\"prepay_id=wx20161110170047bcdbb064010151875703\",\"paySign\":\"DAF683A91309AD4ECF3B792BC903BE3D\"}";
  json = $.parseJSON(json);
    $(function()
    {
      alert("页面初始化");        
      if (typeof WeixinJSBridge == "undefined"){
         if( document.addEventListener )
         {
             document.addEventListener('WeixinJSBridgeReady',onBridgeReady,false);
         }
         else if (document.attachEvent)
         {
             document.attachEvent('WeixinJSBridgeReady',onBridgeReady); 
             document.attachEvent('onWeixinJSBridgeReady',onBridgeReady);
         }
      }
      else
      {
             onBridgeReady();
      } 
      
//      $.ajax({
//					async :false,
//					type : 'GET',
//					url : 'http://ipp.pnrtec.com/ipp-pay/test/xym.html',
//					datatype : 'json',
//					data :{}  ,
//					success : function(resp){
//						alert(JSON.stringify(resp));
//					},
//					error : function(err){
//						alert(JSON.stringify(err));
//					}
//			});
			
//      $.getJSON("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx19783cdd5801fa65&redirect_uri=http%3A%2F%2Fipp.pnrtec.com%2Fipp-pay%2Ftest%2Fxym.html&response_type=code&scope=snsapi_base#wechat_redirect",function(json){
//      	alert(JSON.stringify(json));
//  		});
    });
    
function onBridgeReady(){
 alert("打印请求参数:\n"+JSON.stringify(json));  
   
 WeixinJSBridge.invoke(
   'getBrandWCPayRequest',{
       "appId" : json.appId,    
       "timeStamp" : json.timeStamp,        
       "nonceStr" :  json.nonceStr,
       "package" :json.package,    
       "signType" :json.signType,             
       "paySign" : json.paySign  
   },
   function(res){        
       alert("打印应答参数:\n"+JSON.stringify(res));
        
       if(res.err_msg == "get_brand_wcpay_request：ok" ) 
       {
       	
       }     
       	
   }
 ); 
   
}
</script>
</head>

<body>

</body>
</html>
